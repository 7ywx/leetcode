import pandas as pd

# 创建示例数据
data = {
    'player_id': [1, 1, 2, 3, 3, 3],
    'device_id': [2, 2, 3, 1, 4, 1],
    'event_date': ['2016-03-01', '2016-05-02', '2017-06-25', '2016-03-02', '2018-07-03', '2016-08-04'],
    'games_played': [5, 6, 1, 0, 5, 3]
}

df = pd.DataFrame(data)

# 添加 first_login 列
df['first_login'] = pd.to_datetime(df['event_date'])
df['first_login'] = df.groupby('player_id')['first_login'].transform('min')
df.dropna(subset=['first_login'], inplace=True)

# 输出结果
print(df)